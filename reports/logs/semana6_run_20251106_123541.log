==========================================================
 ğŸ§  Semana 6 â€“ Pipeline completo de modelado predictivo
 Log: reports/logs/semana6_run_20251106_123541.log
==========================================================

[12:35:42] â–¶ï¸  ğŸ“¦ [1/9] Construyendo datasets...
Comando: python scripts/build_dataset_ml.py && python scripts/build_dataset_integrado.py

=== [1] CARGA DE FUENTES ===
âœ… Cargado DS_DASH_Obra_1A.csv                      â†’ 326 filas, 13 cols
âœ… Cargado DS_DASH_Obra_2A_3A.csv                   â†’ 552 filas, 23 cols
âœ… Cargado DS_DASH_Obra_2B.csv                      â†’ 1613 filas, 7 cols
âœ… Cargado DS_DASH_Obra_3B.csv                      â†’ 5249 filas, 21 cols
âœ… Cargado DS_DASH_Obra_3C.csv                      â†’ 5249 filas, 9 cols
âœ… Cargado DS_DASH_Obra_4A.csv                      â†’ 326 filas, 10 cols
âœ… Cargado DS_DASH_Obra_4B.csv                      â†’ 326 filas, 16 cols
âœ… Cargado DS_DASH_Obra_5A.csv                      â†’ 634 filas, 16 cols
âœ… Cargado DS_DASH_Empresa_1A.csv                   â†’ 553 filas, 10 cols
âœ… Cargado DS_DASH_Empresa_1B.csv                   â†’ 2148 filas, 6 cols
âœ… Cargado DS_DASH_Empresa_2A.csv                   â†’ 371 filas, 12 cols
âœ… Cargado DS_DASH_Empresa_2B.csv                   â†’ 5395 filas, 5 cols
âœ… Cargado DS_DASH_Empresa_2C.csv                   â†’ 26 filas, 3 cols
âœ… Cargado DS_DASH_Miembro_1A.csv                   â†’ 1613 filas, 11 cols
âœ… Cargado DS_DASH_Miembro_2A.csv                   â†’ 739 filas, 9 cols
âœ… Cargado DS_DASH_Miembro_3A.csv                   â†’ 2606 filas, 5 cols
âœ… Cargado DS_DASH_Miembro_3B.csv                   â†’ 643 filas, 5 cols

ğŸ“Š Obras: (14179, 56), Empresas: (8202, 26), Funcionarios: (5317, 17)

=== [2] CARGA DE PERFILAMIENTO DE RIESGO ===
âš ï¸ Error leyendo perfilamiento_obra_riesgosa.xlsx: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
âš ï¸ Error leyendo perfilamiento_empresa_riesgosa.xlsx: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.

=== [3] UNIFICACIÃ“N DE FUENTES ===
âœ… Dataset unificado temporal: 14179 filas, 56 columnas

=== [4] CREACIÃ“N DE VARIABLE OBJETIVO (y_riesgo) ===
âœ… Etiqueta creada desde columna existente: RIESGO_OBRA

=== [5] SELECCIÃ“N DE VARIABLES ===

=== [6] LIMPIEZA FINAL ===
Traceback (most recent call last):
  File "D:\IA_Investigacion\Deteccion_Corrupcion\scripts\build_dataset_ml.py", line 149, in <module>
    main()
  File "D:\IA_Investigacion\Deteccion_Corrupcion\scripts\build_dataset_ml.py", line 144, in main
    df_final.to_parquet(out_file, index=False)
  File "C:\Python312\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\core\frame.py", line 3113, in to_parquet
    return to_parquet(
           ^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parquet.py", line 476, in to_parquet
    impl = get_engine(engine)
           ^^^^^^^^^^^^^^^^^^
  File "C:\Python312\Lib\site-packages\pandas\io\parquet.py", line 67, in get_engine
    raise ImportError(
ImportError: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
