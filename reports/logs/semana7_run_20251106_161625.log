==========================================================
 üöÄ Semana 7 ‚Äì Experimentos de optimizaci√≥n de hiperpar√°metros
 Log: reports/logs/semana7_run_20251106_161625.log
==========================================================

[16:16:26] ‚ñ∂Ô∏è  Random Search
=== RANDOM SEARCH ===
Traceback (most recent call last):
  File "D:\IA_Investigacion\Deteccion_Corrupcion\scripts\opt_random_search.py", line 47, in <module>
    f1 = cross_val_score(model, X, y, cv=cv, scoring=scorer, n_jobs=-1).mean()
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\utils\_param_validation.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\model_selection\_validation.py", line 677, in cross_val_score
    cv_results = cross_validate(
                 ^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\utils\_param_validation.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\model_selection\_validation.py", line 419, in cross_validate
    _warn_or_raise_about_fit_failures(results, error_score)
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\model_selection\_validation.py", line 505, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 407, in pandas_feature_info
    new_feature_types.append(_pandas_dtype_mapper[dtype.name])
                             ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'object'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\model_selection\_validation.py", line 859, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\sklearn.py", line 1784, in fit
    train_dmatrix, evals = _wrap_evaluation_matrices(
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\sklearn.py", line 701, in _wrap_evaluation_matrices
    train_dmatrix = create_dmatrix(
                    ^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\sklearn.py", line 1254, in _create_dmatrix
    return QuantileDMatrix(
           ^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 1768, in __init__
    self._init(
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 1832, in _init
    it.reraise()
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 617, in reraise
    raise exc  # pylint: disable=raising-bad-type
    ^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 598, in _handle_exception
    return fn()
           ^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 685, in <lambda>
    return self._handle_exception(lambda: int(self.next(input_data)), 0)
                                              ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 1632, in next
    input_data(**self.kwargs)
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 665, in input_data
    new, feature_names, feature_types = _proxy_transform(
                                        ^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 1685, in _proxy_transform
    df, feature_names, feature_types = _transform_pandas_df(
                                       ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 662, in _transform_pandas_df
    feature_names, feature_types = pandas_feature_info(
                                   ^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 409, in pandas_feature_info
    _invalid_dataframe_dtype(data)
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 372, in _invalid_dataframe_dtype
    raise ValueError(msg)
ValueError: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:CODIGO_UNICO: object, SECTOR: object, DEPARTAMENTO: object, NIVEL_GOBIERNO: object, IDENTIFICADOR_OBRA: object, OBJETO_PROCESO: object, NOMBREOBRA: object, METODO_CONTRATACION: object, __SOURCE: object, RAZON_SOCIAL: object, MIEMBROS_DE_COMITE: object, NUMERO_CONTRATO: object, NOMBRE_MIEMBRO_COMITE: object, NOMBRE_PARTICIPANTE: object, NOMBRE_EMPRESA_GANADORA: object, NOMBRE_EMPRESA_PARTICIPANTE: object, NOMBRE_OBRA: object, EMPRESA_EJECUTORA: object, EMPRESA_SUPERVISORA: object, ESTADO_OBRA: object, ETAPA: object, RIESGO_DESCRIPCION_OBRA: object, IND_INTERVENSION: object, IND_RESIDENTE: object, IND_MONTO_ADELANTO_MATERIALES: object, IND_MONTO_ADELANTO_DIRECTO: object, IND_FECHA_ADELANTO_MATERIALES: object, IND_FECHA_ADELANTO_DIRECTO: object

‚ùå Error en Random Search

[16:17:10] ‚ñ∂Ô∏è  Bayesian Optimization
|   iter    |  target   | n_esti... | max_depth | learni... | subsample | colsam... |
-------------------------------------------------------------------------------------
Traceback (most recent call last):
  File "D:\IA_Investigacion\Deteccion_Corrupcion\scripts\opt_bayes_opt.py", line 52, in <module>
    optimizer.maximize(init_points=5, n_iter=15)
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\bayes_opt\bayesian_optimization.py", line 322, in maximize
    self.probe(x_probe, lazy=False)
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\bayes_opt\bayesian_optimization.py", line 239, in probe
    self._space.probe(params)
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\bayes_opt\target_space.py", line 555, in probe
    target = self.target_func(**dict_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\scripts\opt_bayes_opt.py", line 40, in xgb_cv
    f1 = cross_val_score(model, X, y, cv=cv, scoring=scorer, n_jobs=-1).mean()
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\utils\_param_validation.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\model_selection\_validation.py", line 677, in cross_val_score
    cv_results = cross_validate(
                 ^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\utils\_param_validation.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\model_selection\_validation.py", line 419, in cross_validate
    _warn_or_raise_about_fit_failures(results, error_score)
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\model_selection\_validation.py", line 505, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 407, in pandas_feature_info
    new_feature_types.append(_pandas_dtype_mapper[dtype.name])
                             ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'object'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\sklearn\model_selection\_validation.py", line 859, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\sklearn.py", line 1784, in fit
    train_dmatrix, evals = _wrap_evaluation_matrices(
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\sklearn.py", line 701, in _wrap_evaluation_matrices
    train_dmatrix = create_dmatrix(
                    ^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\sklearn.py", line 1254, in _create_dmatrix
    return QuantileDMatrix(
           ^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 1768, in __init__
    self._init(
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 1832, in _init
    it.reraise()
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 617, in reraise
    raise exc  # pylint: disable=raising-bad-type
    ^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 598, in _handle_exception
    return fn()
           ^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 685, in <lambda>
    return self._handle_exception(lambda: int(self.next(input_data)), 0)
                                              ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 1632, in next
    input_data(**self.kwargs)
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\core.py", line 665, in input_data
    new, feature_names, feature_types = _proxy_transform(
                                        ^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 1685, in _proxy_transform
    df, feature_names, feature_types = _transform_pandas_df(
                                       ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 662, in _transform_pandas_df
    feature_names, feature_types = pandas_feature_info(
                                   ^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 409, in pandas_feature_info
    _invalid_dataframe_dtype(data)
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\xgboost\data.py", line 372, in _invalid_dataframe_dtype
    raise ValueError(msg)
ValueError: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:CODIGO_UNICO: object, SECTOR: object, DEPARTAMENTO: object, NIVEL_GOBIERNO: object, IDENTIFICADOR_OBRA: object, OBJETO_PROCESO: object, NOMBREOBRA: object, METODO_CONTRATACION: object, __SOURCE: object, RAZON_SOCIAL: object, MIEMBROS_DE_COMITE: object, NUMERO_CONTRATO: object, NOMBRE_MIEMBRO_COMITE: object, NOMBRE_PARTICIPANTE: object, NOMBRE_EMPRESA_GANADORA: object, NOMBRE_EMPRESA_PARTICIPANTE: object, NOMBRE_OBRA: object, EMPRESA_EJECUTORA: object, EMPRESA_SUPERVISORA: object, ESTADO_OBRA: object, ETAPA: object, RIESGO_DESCRIPCION_OBRA: object, IND_INTERVENSION: object, IND_RESIDENTE: object, IND_MONTO_ADELANTO_MATERIALES: object, IND_MONTO_ADELANTO_DIRECTO: object, IND_FECHA_ADELANTO_MATERIALES: object, IND_FECHA_ADELANTO_DIRECTO: object

‚ùå Error en Bayesian Optimization

[16:18:00] ‚ñ∂Ô∏è  Resumen de resultados
Traceback (most recent call last):
  File "D:\IA_Investigacion\Deteccion_Corrupcion\scripts\opt_summary.py", line 8, in <module>
    r = pd.read_csv(OUT_DIR/"random_search_results.csv")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "D:\IA_Investigacion\Deteccion_Corrupcion\env\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'reports\\tuning\\random_search_results.csv'
‚ùå Error en Resumen de resultados

[16:18:07] ‚ñ∂Ô∏è  Gr√°fico de evoluci√≥n
Traceback (most recent call last):
  File "D:\IA_Investigacion\Deteccion_Corrupcion\scripts\opt_plot_evolution.py", line 4, in <module>
    import pandas as pd, matplotlib.pyplot as plt, seaborn as sns
ModuleNotFoundError: No module named 'seaborn'
‚ùå Error en Gr√°fico de evoluci√≥n
==========================================================
üèÅ Semana 7 finalizada. Revisa reports/tuning/ para resultados.
==========================================================
